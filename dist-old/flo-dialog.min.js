var FloDialog=function(t){this.id=Date.now(),this.callback=null,this.cloak=this.renderCloakHtml(),this.activeDialog=null,this.content="",this.footerText="",this.config=this.mergeOptions({debug:!1,autoBind:!0,cache:!0,position:"absolute",closeOnCloakClick:!0,effect:{fade:!1,fall:!1}},t),this.config.autoBind&&this.bindFloDialogLinks(),this.domReady(this.loadPolyFills())};FloDialog.prototype.mergeOptions=function(t,e){var o={};for(var i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);return o},FloDialog.prototype.fadeIn=function(t,e){t.style.opacity=0;var o=function(){t.style.opacity=+t.style.opacity+.05,+t.style.opacity<1?window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16):"function"==typeof e&&e()};o()},FloDialog.prototype.bindFloDialogLinks=function(){for(var t=document.querySelectorAll("[data-flo-dialog]"),e=0;e<t.length;e++)this.addEvent(t[e],"click",function(t){t.preventDefault();var e=t.currentTarget?t.currentTarget:t.srcElement;switch(e.getAttribute("data-flo-dialog")){case"partial":this.partialHandler(e);break;case"hidden-element":this.hiddenElementHandler(e);break;case"image":this.imageHandler(e)}}.bind(this))},FloDialog.prototype.partialHandler=function(t){var e={title:t.getAttribute("data-title"),url:t.getAttribute("data-url")};null!==e.url&&""!==e.url&&"javascript:"!==e.url&&"#"!==e.url&&this.openUrl(e.title,e.url)},FloDialog.prototype.hiddenElementHandler=function(t){var e={id:t.getAttribute("data-id"),title:t.getAttribute("data-title")};if(null!==e.id){var o=document.getElementById(e.id),i=document.createElement("div");i.appendChild(o.firstChild.cloneNode(!0)),this.content=i.innerHTML,this.openDialog(e.title)}},FloDialog.prototype.imageHandler=function(t){var e={title:t.getAttribute("data-title"),imageUrl:t.getAttribute("data-image-url")};if(null!==e.imageUrl){var o=document.createElement("img");o.src=e.imageUrl,o.className="flo-dialog__img",this.content=o.outerHTML,this.openDialog(e.title)}},FloDialog.prototype.openUrl=function(e,t,o){var i=this;i.get(t).then(function(t){i.content=t,i.positionDialog(),i.openDialog(e,o)}).catch(function(t){console.error(t)})},FloDialog.prototype.openDialog=function(t,e){var o=this;this.title=t,this.callback=e||null,o.activeDialog?(o.resetContent(),o.updateActiveDialog().then(function(){o.positionDialog()})):o.renderDialog().then(function(t){o.positionDialog(),"function"==typeof e&&e()}).catch(function(t){console.error(t)})},FloDialog.prototype.renderDialog=function(){var t=this.renderDialogHtml(),e=document.getElementsByTagName("body")[0],o=this,i=0;return o.config.debug&&(i=500),e.appendChild(t),this.activeDialog=t,Promise.all([o.showDialog(),o.appendTitle(o.title),o.appendContent(o.content,i)]).then(function(){return t})},FloDialog.prototype.updateActiveDialog=function(){var t=this,e=0;return t.config.debug&&(e=500),Promise.all([this.showDialog(),t.appendTitle(t.title),t.appendContent(t.content,e)]).then(function(){return t.activeDialog})},FloDialog.prototype.showDialog=function(){var o=this.activeDialog,i=this;return new Promise(function(t,e){i.openCloak(),i.positionDialog(),i.config.effect.fade?(o.style.display="block",i.fadeIn(o,function(){i.runEmbeddedJs(),t()})):(i.runEmbeddedJs(),t())})},FloDialog.prototype.positionDialog=function(){var e=(window.pageYOffset||document.body.scrollTop)-(document.body.clientTop||0),o=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=this.activeDialog;this.waitForElement(i,function(){var t=o-o/10;i.style.height="auto",i.style.overflowY="visible",i.offsetHeight>t&&(i.style.overflowY="scroll",i.style.height=t+"px"),"fixed"===this.config.position&&(e=0,i.style.position="fixed"),i.style.top=e+o/2-i.offsetHeight/2+"px",this.config.debug&&(console.log("dialog.offsetHeight: "+i.offsetHeight),console.log("screenHeight: "+o),console.log("positionTop: "+e),console.log("maxHeight: "+t))}.bind(this))},FloDialog.prototype.waitForElement=function(t,e){var o=setInterval(function(){t&&(clearInterval(o),e())},10)},FloDialog.prototype.closeDialog=function(){var t=this.activeDialog||null;void 0!==t&&(this.config.effect.fade&&(this.activeDialog.style.display="none"),this.config.cache||(t.parentNode.removeChild(t),this.activeDialog=null),this.closeCloak())},FloDialog.prototype.openCloak=function(){var t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);void 0!==this.cloak&&(this.cloak.setAttribute("style","height: "+t+"px"),this.cloak.className=this.cloak.className.replace(/\bhide\b/g,""))},FloDialog.prototype.closeCloak=function(){void 0!==this.cloak&&-1===this.cloak.className.indexOf("hide")&&(this.cloak.className+=" hide")},FloDialog.prototype.appendTitle=function(i){var n=this;if(void 0!==n.activeDialog)return new Promise(function(t,e){var o=n.activeDialog.getElementsByClassName("flo-dialog__header")[0];void 0!==o?(o.getElementsByClassName("title")[0].innerHTML=i,t()):e()})},FloDialog.prototype.appendContent=function(i,t){t=t||0;var n=this;if(void 0!==n.activeDialog)return new Promise(function(e,o){setTimeout(function(){var t=n.activeDialog.getElementsByClassName("flo-dialog__body")[0];void 0!==t?(t.innerHTML=i,e()):o()},t)})},FloDialog.prototype.resetContent=function(){this.activeDialog.getElementsByClassName("flo-dialog__body")[0].innerHTML=this.renderSpinnerHtml()},FloDialog.prototype.addEvent=function(t,e,o){t.attachEvent?(t["e"+e+o]=o,t[e+o]=function(){t["e"+e+o](window.event)},t.attachEvent("on"+e,t[e+o])):t.addEventListener(e,o,!1)},FloDialog.prototype.get=function(i){var t=new Promise(function(t,e){var o=new XMLHttpRequest;o.open("GET",i),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.onload=function(){200===o.status?t(o.response):e(Error(o.statusText))},o.send()});return Promise.all([t]).then(function(t){return t[0]})},FloDialog.prototype.renderCloakHtml=function(){var t=document.createElement("div"),e=document.getElementsByTagName("body")[0];return t.className="flo-dialog-cloak hide",e.insertBefore(t,e.firstChild),this.addEvent(t,"click",function(t){t.target!==this.activeDialog&&this.closeDialog()}.bind(this)),t},FloDialog.prototype.renderDialogHtml=function(){var t=document.createElement("div"),e=document.createElement("div"),o=document.createElement("div"),i=document.createElement("header"),n=document.createElement("footer"),l=document.createElement("div"),a=document.createElement("div"),r=document.createElement("h2"),s=document.createElement("a"),c=document.createElement("i");return t.id="flo-dialog-"+this.id,t.className="flo-dialog hide",e.className="flo-dialog__inner",t.appendChild(e),i.className="flo-dialog__header trailer--half",e.appendChild(i),l.className="container container--master",i.appendChild(l),r.className="title title--dialog gutters--double",l.appendChild(r),a.className="container container--slave",a.style.textAlign="right",i.appendChild(a),c.className="fa fa-times",s.appendChild(c),s.href="JavaScript:;",s.className="flo-dialog__close-btn gutters--double",a.appendChild(s),this.addEvent(s,"click",this.closeDialog.bind(this)),o.className="flo-dialog__body gutters--double",o.innerHTML=this.renderSpinnerHtml(),e.appendChild(o),n.className="flo-dialog__footer gutters--double leader-inside--half",n.innerHTML=""!==this.footerText?this.footerText:"&copy; FloDialog "+(new Date).getFullYear()+". All rights reserved.",e.appendChild(n),t},FloDialog.prototype.runEmbeddedJs=function(){for(var scripts=this.activeDialog.getElementsByTagName("script"),i=0;i<scripts.length;i++)eval(scripts[i].text)},FloDialog.prototype.setFooterText=function(t){this.footerText=t},FloDialog.prototype.renderSpinnerHtml=function(){return'<svg class="flo-dialog__spinner" viewBox="0 0 100 100" width="20" height="20"> <circle cx="50" cy="50" r="42" transform="rotate(-90,50,50)" /></svg>'},FloDialog.prototype.loadPolyFills=function(){if(this.isIe()){var t=document.createElement("script"),e=document.getElementsByTagName("head")[0];t.type="text/javascript",t.src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js",e.insertBefore(t,e.firstChild)}},FloDialog.prototype.isIe=function(){return 0<window.navigator.userAgent.indexOf("MSIE ")||!!navigator.userAgent.match(/Trident.*rv\:11\./)},FloDialog.prototype.domReady=function(t){"loading"!==document.readyState?t():document.addEventListener?document.addEventListener("DOMContentLoaded",t):document.attachEvent("onreadystatechange",function(){"loading"!==document.readyState&&t()})};