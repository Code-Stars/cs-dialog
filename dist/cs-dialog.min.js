var CsDialog=function(t){this.id=Date.now(),this.cloak=this.renderCloakHtml(),this.activeDialog=null,this.content="",this.footerText="",this.config=CsUtils.mergeOptions({debug:!1,autoBind:!0,cache:!0,position:"absolute",closeOnCloakClick:!0,effect:{fade:!1,fall:!1}},t),this.config.autoBind&&this.crawlDialogLinks(),CsUtils.isDomReady(CsUtils.loadPolyFills)};CsDialog.prototype.crawlDialogLinks=function(){for(var t=document.querySelectorAll("[data-cs-dialog]"),e=0;e<t.length;e++)CsUtils.addEvent(t[e],"click",function(t){t.preventDefault();var e=t.currentTarget?t.currentTarget:t.srcElement;switch(e.getAttribute("data-cs-dialog")){case"partial":this.partialHandler(e);break;case"hidden-element":this.hiddenElementHandler(e);break;case"image":this.imageHandler(e)}}.bind(this))},CsDialog.prototype.partialHandler=function(t){var e={title:t.getAttribute("data-title"),url:t.getAttribute("data-url")};null!==e.url&&""!==e.url&&"javascript:"!==e.url&&"#"!==e.url&&this.openUrl(e.title,e.url)},CsDialog.prototype.hiddenElementHandler=function(t){var e={id:t.getAttribute("data-id"),title:t.getAttribute("data-title")};if(null!==e.id){var i=document.getElementById(e.id),o=document.createElement("div");o.appendChild(i.firstChild.cloneNode(!0)),this.content=o.innerHTML,this.openDialog(e.title)}},CsDialog.prototype.imageHandler=function(t){var e={title:t.getAttribute("data-title"),imageUrl:t.getAttribute("data-image-url")};if(null!==e.imageUrl){var i=document.createElement("img");i.src=e.imageUrl,i.className="cs-dialog__img",this.content=i.outerHTML,this.openDialog(e.title)}},CsDialog.prototype.openUrl=function(e,t,i){var o=this;CsUtils.get(t).then(function(t){o.content=t,o.positionDialog(),o.openDialog(e,i)}).catch(function(t){console.error(t)})},CsDialog.prototype.openDialog=function(t,e){var i=this;this.title=t,i.activeDialog?(i.resetContent(),i.updateActiveDialog().then(function(){i.positionDialog(),"function"==typeof e&&e()})):i.renderDialog().then(function(t){i.positionDialog(),"function"==typeof e&&e()}).catch(function(t){console.error(t)})},CsDialog.prototype.renderDialog=function(){var t=this.renderDialogHtml(),e=document.getElementsByTagName("body")[0],i=this,o=0;return i.config.debug&&(o=500),e.appendChild(t),this.activeDialog=t,Promise.all([i.showDialog(),i.appendTitle(i.title),i.appendContent(i.content,o)]).then(function(){return t})},CsDialog.prototype.updateActiveDialog=function(){var t=this,e=0;return t.config.debug&&(e=500),Promise.all([this.showDialog(),t.appendTitle(t.title),t.appendContent(t.content,e)]).then(function(){return t.activeDialog})},CsDialog.prototype.showDialog=function(){var i=this.activeDialog,o=this;return new Promise(function(t,e){o.openCloak(),o.positionDialog(),o.config.effect.fade?(i.style.display="block",CsUtils.fadeIn(i,function(){CsUtils.runEmbeddedJs(o.activeDialog),t()})):(CsUtils.runEmbeddedJs(),t())})},CsDialog.prototype.positionDialog=function(){var e=(window.pageYOffset||document.body.scrollTop)-(document.body.clientTop||0),i=Math.max(document.documentElement.clientHeight,window.innerHeight||0),o=this.activeDialog;CsUtils.waitForElement(o,function(){var t=i-i/10;o.style.height="auto",o.style.overflowY="visible",o.offsetHeight>t&&(o.style.overflowY="scroll",o.style.height=t+"px"),"fixed"===this.config.position&&(e=0,o.style.position="fixed"),o.style.top=e+i/2-o.offsetHeight/2+"px",this.config.debug&&(console.log("dialog.offsetHeight: "+o.offsetHeight),console.log("screenHeight: "+i),console.log("positionTop: "+e),console.log("maxHeight: "+t))}.bind(this))},CsDialog.prototype.closeDialog=function(){var t=this.activeDialog||null;void 0!==t&&(this.config.effect.fade&&(this.activeDialog.style.display="none"),this.config.cache||(t.parentNode.removeChild(t),this.activeDialog=null),this.closeCloak())},CsDialog.prototype.openCloak=function(){var t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);void 0!==this.cloak&&(this.cloak.setAttribute("style","height: "+t+"px"),this.cloak.className=this.cloak.className.replace(/\bhide\b/g,""))},CsDialog.prototype.closeCloak=function(){void 0!==this.cloak&&-1===this.cloak.className.indexOf("hide")&&(this.cloak.className+=" hide")},CsDialog.prototype.appendTitle=function(o){var n=this;if(void 0!==n.activeDialog)return new Promise(function(t,e){var i=n.activeDialog.getElementsByClassName("cs-dialog__header")[0];void 0!==i?(i.getElementsByClassName("cs-dialog__title")[0].innerHTML=o,t()):e()})},CsDialog.prototype.appendContent=function(o,t){t=t||0;var n=this;if(void 0!==n.activeDialog)return new Promise(function(e,i){setTimeout(function(){var t=n.activeDialog.getElementsByClassName("cs-dialog__body")[0];void 0!==t?(t.innerHTML=o,e()):i()},t)})},CsDialog.prototype.resetContent=function(){this.activeDialog.getElementsByClassName("cs-dialog__body")[0].innerHTML=this.renderSpinnerHtml()},CsDialog.prototype.renderCloakHtml=function(){var t=document.createElement("div"),e=document.getElementsByTagName("body")[0];return t.className="cs-dialog-cloak hide",e.insertBefore(t,e.firstChild),CsUtils.addEvent(t,"click",function(t){t.target!==this.activeDialog&&this.closeDialog()}.bind(this)),t},CsDialog.prototype.renderDialogHtml=function(){var t=document.createElement("div"),e=document.createElement("div"),i=document.createElement("div"),o=document.createElement("header"),n=document.createElement("footer"),a=document.createElement("div"),l=document.createElement("div"),s=document.createElement("h2"),r=document.createElement("a"),c=document.createElement("i");return t.id="cs-dialog-"+this.id,t.className="cs-dialog extend hide",e.className="cs-dialog__inner",t.appendChild(e),o.className="cs-dialog__header",e.appendChild(o),a.className="cs-dialog__container-master",o.appendChild(a),s.className="cs-dialog__title",a.appendChild(s),l.className="cs-dialog__container-slave",l.style.textAlign="right",o.appendChild(l),c.className="fas fa-times",r.appendChild(c),r.href="JavaScript:;",r.className="cs-dialog__close-btn",l.appendChild(r),CsUtils.addEvent(r,"click",this.closeDialog.bind(this)),i.className="cs-dialog__body",i.innerHTML=this.renderSpinnerHtml(),e.appendChild(i),""!==this.footerText&&(n.className="cs-dialog__footer",n.innerHTML=this.footerText,e.appendChild(n)),t},CsDialog.prototype.setFooterText=function(t){this.footerText=t},CsDialog.prototype.renderSpinnerHtml=function(){return'<svg class="cs-dialog__spinner" viewBox="0 0 100 100" width="20" height="20"> <circle cx="50" cy="50" r="42" transform="rotate(-90,50,50)" /></svg>'},CsDialog.prototype.openWithContent=function(t,e){this.openDialog(t,function(){this.appendContent(e)}.bind(this))};var CsUtils={isIe:function(){return 0<window.navigator.userAgent.indexOf("MSIE ")||!!navigator.userAgent.match(/Trident.*rv\:11\./)},isDomReady:function(t){/in/.test(document.readyState)?setTimeout(function(){CsUtils.isDomReady(t)},10):t()},loadPolyFills:function(){if("undefined"==typeof Promise){var t=document.createElement("script"),e=document.getElementsByTagName("head")[0];t.type="text/javascript",t.src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js",e.insertBefore(t,e.firstChild)}},addEvent:function(t,e,i){t.attachEvent?(t["e"+e+i]=i,t[e+i]=function(){t["e"+e+i](window.event)},t.attachEvent("on"+e,t[e+i])):t.addEventListener(e,i,!1)},get:function(o){var t=new Promise(function(t,e){var i=new XMLHttpRequest;i.open("GET",o),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.onload=function(){200===i.status?t(i.response):e(Error(i.statusText))},i.send()});return Promise.all([t]).then(function(t){return t[0]})},waitForElement:function(t,e){var i=setInterval(function(){t&&(clearInterval(i),e())},10)},fadeIn:function(t,e){t.style.opacity=0;var i=function(){t.style.opacity=+t.style.opacity+.05,+t.style.opacity<1?window.requestAnimationFrame&&requestAnimationFrame(i)||setTimeout(i,16):"function"==typeof e&&e()};i()},mergeOptions:function(t,e){var i={};for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i},runEmbeddedJs:function(container){for(var scripts=container.getElementsByTagName("script"),i=0;i<scripts.length;i++)eval(scripts[i].text)}};