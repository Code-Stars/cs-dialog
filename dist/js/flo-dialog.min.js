var FloDialog=function(t){this.id=Date.now(),this.cloak=this.renderCloakHtml(),this.activeDialog=null,this.content=null,this.footerText="",this.config=this.mergeOptions({cache:!0,position:"absolute",closeOnCloakClick:!0,effect:{fade:!1,fall:!1}},t),this.bindTriggers()};FloDialog.prototype.mergeOptions=function(t,e){var o={};for(var i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);return o},FloDialog.prototype.fadeIn=function(t,e){t.style.opacity=0;var o=function(){t.style.opacity=+t.style.opacity+.05,+t.style.opacity<1?window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16):"function"==typeof e&&e()};o()},FloDialog.prototype.bindTriggers=function(){for(var t=document.querySelectorAll('[data-dialog="flo-dialog"]'),e=0;e<t.length;e++)this.addEvent(t[e],"click",function(t){t.preventDefault();var e=t.currentTarget?t.currentTarget:t.srcElement,o=document.createElement("div"),i={id:e.getAttribute("data-id"),title:e.getAttribute("data-title"),url:e.getAttribute("data-url"),imageUrl:e.getAttribute("data-image-url")};if(null!==i.id){var n=document.getElementById(i.id);o.appendChild(n.firstChild.cloneNode(!0)),this.setContent(o),this.openDialog(i.title)}if(null!==i.imageUrl){var l=this.loadImageContent(i.imageUrl);o.appendChild(l),this.setContent(o),this.openDialog(i.title)}null!==i.url&&""!==i.url&&"javascript:"!==i.url&&"#"!==i.url&&this.openUrl(i.title,i.url,null)}.bind(this),!1)},FloDialog.prototype.openUrl=function(t,e,o){var i=document.createElement("span"),n=document.createElement("div");i.textContent="Loading...",n.appendChild(i),this.get(e,function(e){n.innerHTML=e.data,this.waitForElement(n,function(){this.setContent(n),this.positionDialog(),this.openDialog(t),"function"==typeof o&&o()}.bind(this))}.bind(this))},FloDialog.prototype.openDialog=function(t,e){var o=this.renderContainerHtml(this.content);document.getElementsByTagName("body")[0].appendChild(o),this.initCloseTriggers(o),void 0!==o&&(this.activeDialog=o,this.openCloak(),this.positionDialog(function(){this.config.effect.fade?this.fadeIn(o,function(){"function"==typeof e&&e()}):(o.className=o.className.replace(/\bhide\b/,""),"function"==typeof e&&e()),this.appendTitle(t)}.bind(this)))},FloDialog.prototype.positionDialog=function(t){var e=(window.pageYOffset||document.body.scrollTop)-(document.body.clientTop||0),o=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=this.activeDialog;this.waitForElement(i,function(){i.style.top=e+o/2-i.offsetHeight/2+"px","fixed"===this.config.position&&(i.style.position="fixed"),"function"==typeof t&&t()}.bind(this))},FloDialog.prototype.waitForElement=function(t,e){var o=setInterval(function(){t&&(clearInterval(o),e())},10)},FloDialog.prototype.initCloseTriggers=function(t){for(var e=t.getElementsByClassName("flo-dialog__close-btn"),o=0;o<e.length;o++)this.addEvent(e[o],"click",function(){this.closeDialog(this.activeDialog)}.bind(this),!1);void 0!==this.cloak&&this.config.closeOnCloakClick&&this.addEvent(this.cloak,"click",function(t){t.target!==this.activeDialog&&this.closeDialog(this.activeDialog)}.bind(this),!1)},FloDialog.prototype.closeDialog=function(t){void 0!==t&&(this.config.cache?t.style.display="none":t.parentNode.removeChild(t),this.closeCloak())},FloDialog.prototype.openCloak=function(){var t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);void 0!==this.cloak&&(this.cloak.setAttribute("style","height: "+t+"px"),this.cloak.className=this.cloak.className.replace(/\bhide\b/g,""))},FloDialog.prototype.closeCloak=function(){void 0!==this.cloak&&-1===this.cloak.className.indexOf("hide")&&(this.cloak.className+=" hide")},FloDialog.prototype.appendTitle=function(t){if(void 0!==this.activeDialog){var e;void 0!==(e=this.activeDialog.getElementsByClassName("flo-dialog__header")[0])&&(e.getElementsByClassName("title")[0].innerHTML=t)}},FloDialog.prototype.addEvent=function(t,e,o){t.attachEvent?(t["e"+e+o]=o,t[e+o]=function(){t["e"+e+o](window.event)},t.attachEvent("on"+e,t[e+o])):t.addEventListener(e,o,!1)},FloDialog.prototype.loadImageContent=function(t){var e=document.createElement("img");return e.src=t,e.className="flo-dialog__img",e},FloDialog.prototype.get=function(t,e){var o=new XMLHttpRequest,i={};o.open("GET",t),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.onload=function(){200===o.status?(i.data=o.responseText,e(i)):console.error("Request failed.  Returned status of "+o.status)},o.send()},FloDialog.prototype.renderCloakHtml=function(){var t=document.createElement("div"),e=document.getElementsByTagName("body")[0];return t.className="flo-dialog-cloak hide",e.insertBefore(t,e.firstChild),t},FloDialog.prototype.renderContainerHtml=function(t){t=t||document.createElement("div");var e=document.createElement("div"),o=document.createElement("header"),i=document.createElement("footer"),n=document.createElement("div"),l=document.createElement("div"),a=document.createElement("h2"),s=document.createElement("a"),r=document.createElement("i");return e.id="flo-dialog-"+this.id,e.className="flo-dialog hide",o.className="flo-dialog__header trailer--half",e.appendChild(o),n.className="container container--master",o.appendChild(n),a.className="title title--section gutters--double",a.innerHTML="No title was set!",n.appendChild(a),l.className="container container--slave",l.style.textAlign="right",o.appendChild(l),r.className="fa fa-times",s.appendChild(r),s.href="JavaScript:;",s.className="flo-dialog__close-btn gutters--double",l.appendChild(s),t.className="flo-dialog__body gutters--double",e.appendChild(t),i.className="flo-dialog__footer gutters--double leader-inside--half",i.innerHTML=""!==this.footerText?this.footerText:"&copy; FloDialog 2017. All rights reserved.",e.appendChild(i),e},FloDialog.prototype.setContent=function(t){this.content=t},FloDialog.prototype.setFooterText=function(t){this.footerText=t};