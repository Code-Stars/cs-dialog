var FloDialog=function(t){this.id=Date.now(),this.cloak=this.renderCloakHtml(),this.activeDialog=null,this.footerText="",this.config=this.mergeConfig({cache:!0,fade:!1,position:"absolute"},t),this.bindTriggers()};FloDialog.prototype.mergeConfig=function(t,e){var o={};for(var i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);for(var a in e)e.hasOwnProperty(a)&&(o[a]=e[a]);return o},FloDialog.prototype.fadeIn=function(t){t.style.opacity=0;var e=function(){t.style.opacity=+t.style.opacity+.05,+t.style.opacity<1&&(window.requestAnimationFrame&&requestAnimationFrame(e)||setTimeout(e,16))};e()},FloDialog.prototype.bindTriggers=function(){for(var t=document.querySelectorAll('[data-dialog="flo-dialog"]'),e=0;e<t.length;e++)this.addEvent(t[e],"click",function(t){t.preventDefault();var e=t.currentTarget?t.currentTarget:t.srcElement,o=document.createElement("div"),i={title:e.getAttribute("data-title"),url:e.getAttribute("data-url"),imageUrl:e.getAttribute("data-image-url"),id:e.getAttribute("data-id")};if(null!==i.id){var a=document.getElementById(i.id);o.appendChild(a.firstChild)}if(null!==i.url&&""!==i.url&&"javascript:"!==i.url&&"#"!==i.url){var l=document.createElement("span");l.innerHTML="Loading...",o.appendChild(l),this.loadContentFromUrl(i.url)}if(null!==i.imageUrl){var n=this.loadImageContent(i.imageUrl);o.appendChild(n)}this.openDialog(this.renderContainerHtml(o)),this.setTitle(i.title)}.bind(this),!1)},FloDialog.prototype.setHeight=function(t,e){void 0!==t&&t.getElementsByClassName("flo-dialog__body")[0].setAttribute("style","height:"+e+"px; overflow-y: scroll")},FloDialog.prototype.openDialog=function(t){document.getElementsByTagName("body")[0].appendChild(t),this.initCloseTriggers(t),void 0!==t&&(this.activeDialog=t,this.openCloak(),this.positionDialog(t,function(){this.config.fade?this.fadeIn(t):t.className=t.className.replace(/\bhide\b/,"")}.bind(this)))},FloDialog.prototype.positionDialog=function(t,e){var o=(window.pageYOffset||document.body.scrollTop)-(document.body.clientTop||0),i=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.waitForElement(t,function(){t.setAttribute("style","top:"+(o+i/2-t.offsetHeight/2)+"px"),"fixed"===this.config.position&&(t.style.position="fixed"),e()}.bind(this))},FloDialog.prototype.waitForElement=function(t,e){var o=setInterval(function(){t&&(clearInterval(o),e())},10)},FloDialog.prototype.initCloseTriggers=function(t){for(var e=t.getElementsByClassName("flo-dialog--close"),o=0;o<e.length;o++)this.addEvent(e[o],"click",function(){this.closeDialog(this.activeDialog)}.bind(this),!1);void 0!==this.cloak&&this.addEvent(this.cloak,"click",function(t){t.target!==this.activeDialog&&this.closeDialog(this.activeDialog)}.bind(this),!1)},FloDialog.prototype.closeDialog=function(t){void 0!==t&&(this.config.cache?t.style.display="none":t.parentNode.removeChild(t),this.closeCloak())},FloDialog.prototype.openCloak=function(){var t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);void 0!==this.cloak&&(this.cloak.setAttribute("style","height: "+t+"px"),this.cloak.className=this.cloak.className.replace(/\bhide\b/g,""))},FloDialog.prototype.closeCloak=function(){void 0!==this.cloak&&-1===this.cloak.className.indexOf("hide")&&(this.cloak.className+=" hide")},FloDialog.prototype.setTitle=function(t){if(void 0!==this.activeDialog){var e;void 0!==(e=this.activeDialog.getElementsByClassName("flo-dialog__header")[0])&&(e.getElementsByClassName("title")[0].innerHTML=t)}},FloDialog.prototype.clearContainer=function(t){t.innerHTML=""},FloDialog.prototype.addEvent=function(t,e,o){t.attachEvent?(t["e"+e+o]=o,t[e+o]=function(){t["e"+e+o](window.event)},t.attachEvent("on"+e,t[e+o])):t.addEventListener(e,o,!1)},FloDialog.prototype.setYOffset=function(t){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.activeDialog.setAttribute("style","top:"+(t+e/2-this.activeDialog.offsetHeight/2)+"px")},FloDialog.prototype.loadContentFromUrl=function(t){this.get(t,function(t){setTimeout(function(){this.activeDialog.getElementsByClassName("flo-dialog__body")[0].innerHTML=t.data}.bind(this),1e3)}.bind(this))},FloDialog.prototype.loadImageContent=function(t){var e=document.createElement("img");return e.src=t,e.className="flo-dialog__img",e},FloDialog.prototype.get=function(t,e){var o=new XMLHttpRequest,i={};o.open("GET",t),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.onload=function(){200===o.status?(i.data=o.responseText,e(i)):console.error("Request failed.  Returned status of "+o.status)},o.send()},FloDialog.prototype.renderCloakHtml=function(){var t=document.createElement("div"),e=document.getElementsByTagName("body")[0];return t.className="flo-dialog-cloak hide",e.insertBefore(t,e.firstChild),t},FloDialog.prototype.renderContainerHtml=function(t){var e=document.createElement("div"),o=document.createElement("header"),i=document.createElement("footer"),a=document.createElement("div"),l=document.createElement("div"),n=document.createElement("h2"),s=document.createElement("a");return e.id="flo-dialog-"+this.id,e.className="flo-dialog hide",o.className="flo-dialog__header trailer--half",e.appendChild(o),a.className="container container--master",o.appendChild(a),n.className="title title--section gutters--double",n.innerHTML="No title was set!",a.appendChild(n),l.className="container container--slave",l.style="text-align: right",o.appendChild(l),s.href="JavaScript:;",s.className="flo-dialog--close gutters--double fa fa-times",s.innerHTML="x",l.appendChild(s),void 0!==t&&null!==t&&(t.className="flo-dialog__body gutters--double",e.appendChild(t)),i.className="flo-dialog__footer gutters--double leader-inside--half",i.innerHTML=""!==this.footerText?this.footerText:"&copy; FloDialog 2017. All rights reserved.",e.appendChild(i),e},FloDialog.prototype.setFooterText=function(t){this.footerText=t};